境界条件
=================

論文を書くときは

* :math:`x` , :math:`y` : 水平方向
* :math:`z` : 鉛直方向
  
となっているが、R2D2のコード内では

* ``x``: 鉛直方向
* ``y``, ``z``: 水平方向
  
となっている。この取扱説明書では、コードに合わせた表記を用いる。

また、対称・反対称とは以下のような状況を表す。

.. image:: figs/bc_sym.png
   :width: 450 px


上部境界
-----------------------

ポテンシャル磁場
:::::::::::::::::::::::
磁場があるときは、上部ではポテンシャル磁場境界条件を使う。


下部境界
-----------------------

開く時
どの質量フラックスも対称にする。 計算領域内での質量を一定に保つために、水平に平均した密度
:math:`\langle \rho_1\rangle` は反対称。 そこからのずれ
:math:`\rho_1 - \langle \rho_1 \rangle` は対称な境界条件をとる。

一方、エントロピー :math:`s_1` は上昇流で反対称、下降流で反対称な境界条件をとる。
この心は、開く境界条件を取るときは計算をしている領域の結果は信用するが、外から入ってくる物理量は、
計算領域に寄らないというものである。 下降流は現在計算している領域内部での情報を持って計算領域の外に出ていくので、
対称な境界条件を用いる。一方、上昇流は、計算している領域の外からの情報を持って計算領域に入ってくるので、
反対称な境界条件を用いて擾乱をゼロにする。これは元々のModel Sでの量を上昇流のエントロピーに用いるということである。

最終更新日：|today|
